// Ожидание загрузки DOM
window.addEventListener('DOMContentLoaded', function() {
    // Мобильное меню
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    const mobileMenuItems = document.querySelectorAll('.mobile-menu-item-has-children');
    
    // Открытие/закрытие мобильного меню
    if (mobileMenuBtn && mobileMenu) {
        mobileMenuBtn.addEventListener('click', function() {
            mobileMenu.classList.toggle('opened');
            
            // Анимация кнопки бургера
            const spans = mobileMenuBtn.querySelectorAll('span');
            if (mobileMenu.classList.contains('opened')) {
                spans[0].style.transform = 'rotate(45deg) translate(5px, 5px)';
                spans[1].style.opacity = '0';
                spans[2].style.transform = 'rotate(-45deg) translate(7px, -6px)';
            } else {
                spans[0].style.transform = 'none';
                spans[1].style.opacity = '1';
                spans[2].style.transform = 'none';
            }
        });
        
        // Закрытие меню при клике на ссылку
        const mobileLinks = mobileMenu.querySelectorAll('a');
        mobileLinks.forEach(link => {
            link.addEventListener('click', function() {
                if (!this.parentElement.classList.contains('mobile-menu-item-has-children')) {
                    mobileMenu.classList.remove('opened');
                    spans[0].style.transform = 'none';
                    spans[1].style.opacity = '1';
                    spans[2].style.transform = 'none';
                }
            });
        });
    }
    
    // Открытие/закрытие подменю в мобильном меню
    mobileMenuItems.forEach(item => {
        const link = item.querySelector('a');
        const arrow = item.querySelector('.mobile-arrow');
        
        link.addEventListener('click', function(e) {
            if (window.innerWidth <= 768) {
                e.preventDefault();
                item.classList.toggle('active');
            }
        });
    });
    
    // Плавная прокрутка для якорных ссылок
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            const href = this.getAttribute('href');
            
            if (href === '#') return;
            
            const target = document.querySelector(href);
            if (target) {
                e.preventDefault();
                window.scrollTo({
                    top: target.offsetTop - 80,
                    behavior: 'smooth'
                });
            }
        });
    });
    
    // Кнопки для прокрутки к форме
    const scrollToFormBtn = document.getElementById('scrollToForm');
    const individualTariffBtn = document.getElementById('individualTariff');
    
    if (scrollToFormBtn) {
        scrollToFormBtn.addEventListener('click', function() {
            const formSection = document.getElementById('contact');
            if (formSection) {
                window.scrollTo({
                    top: formSection.offsetTop - 80,
                    behavior: 'smooth'
                });
            }
        });
    }
    
    if (individualTariffBtn) {
        individualTariffBtn.addEventListener('click', function() {
            const formSection = document.getElementById('contact');
            if (formSection) {
                window.scrollTo({
                    top: formSection.offsetTop - 80,
                    behavior: 'smooth'
                });
            }
        });
    }
    
    // Кнопки выбора тарифа
    const tariffButtons = document.querySelectorAll('.price-card .btn');
    tariffButtons.forEach(button => {
        button.addEventListener('click', function() {
            const formSection = document.getElementById('contact');
            if (formSection) {
                window.scrollTo({
                    top: formSection.offsetTop - 80,
                    behavior: 'smooth'
                });
            }
        });
    });
});